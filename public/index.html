<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>T·ª∑ Ph√∫ B·∫ßu Tr·ªùi</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <link rel="stylesheet" href="style.css">
    <style>
        /* ================= LOADING SCREEN CSS ================= */
        body {
            background-color: #0f0f1a;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'ui-sans-serif', 'system-ui', 'sans-serif';
        }

        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #0f0f1a;
            z-index: 99999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease-out;
        }

        /* Hi·ªáu ·ª©ng n·ªÅn m·ªù ·∫£o */
        .loading-bg {
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, #1e3a8a 0%, #0f0f1a 70%);
            opacity: 0.6;
            z-index: -1;
        }

        /* ·∫¢nh Logo Game */
        .loading-logo {
            width: 280px; /* ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc ·∫£nh */
            max-width: 80%;
            height: auto;
            border-radius: 20px;
            box-shadow: 0 0 40px rgba(59, 130, 246, 0.5); /* √Ånh s√°ng xanh bao quanh */
            margin-bottom: 40px;
            animation: float 3s ease-in-out infinite; /* Hi·ªáu ·ª©ng bay b·ªïng */
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        /* Thanh Loading */
        .loading-bar-container {
            width: 70%;
            max-width: 300px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.5);
        }

        .loading-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #3b82f6);
            background-size: 200% 100%;
            width: 0%; /* JS s·∫Ω update c√°i n√†y */
            border-radius: 10px;
            animation: shimmer 1.5s infinite linear;
            transition: width 0.3s ease-out;
        }

        @keyframes shimmer {
            0% { background-position: 100% 0; }
            100% { background-position: -100% 0; }
        }

        .loading-text {
            color: #9ca3af;
            font-size: 12px;
            margin-top: 10px;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .plane-icon {
            position: absolute;
            top: -25px;
            right: -10px;
            font-size: 20px;
            transform: rotate(45deg);
            filter: drop-shadow(0 0 5px #3b82f6);
        }
    </style>
</head>
<body>

    <div id="loading-screen">
        <div class="loading-bg"></div>
        
        <img src="https://i.imgur.com/zoDGpUC.jpeg" alt="T·ª∑ Ph√∫ B·∫ßu Tr·ªùi" class="loading-logo" 
             onerror="this.src='https://placehold.co/300x200/1e293b/white?text=TY+PHU+BAU+TROI'"> 
        <div class="relative w-[70%] max-w-[300px]">
            <div class="loading-bar-container">
                <div id="loading-progress" class="loading-bar-fill"></div>
            </div>
        </div>

        <div id="loading-text" class="loading-text">ƒêang kh·ªüi ƒë·ªông ƒë·ªông c∆°...</div>
    </div>

    <div class="absolute top-0 left-0 w-full h-full z-0 overflow-hidden pointer-events-none">
        <div class="absolute top-[-10%] left-[-10%] w-[60%] h-[60%] bg-blue-900/10 blur-[120px] rounded-full"></div>
    </div>

    <div class="z-10 flex flex-col h-full w-full max-w-lg mx-auto bg-black/20 border-x border-white/5 h-screen relative">

        <div class="pt-4 px-4 pb-2 z-20 relative flex-shrink-0">
            <div class="flex items-center mb-4">
                <div class="flex items-center gap-2 bg-[#2d2d3e]/80 py-1 px-3 rounded-full border border-white/10">
                    <span class="text-xl">‚úàÔ∏è</span>
                    <span class="text-sm font-bold">T·ª∑ Ph√∫ B·∫ßu Tr·ªùi</span>
                </div>
                <div class="ml-auto flex items-center gap-2">
                    <div id="mini-diamond" class="items-center gap-2 bg-black/40 px-3 py-1 rounded-full border border-white/10 flex">
                        <span class="text-lg">üíé</span>
                        <span id="mini-diamond-text" class="text-sm font-bold text-blue-400">0</span>
                    </div>
                    <div id="mini-balance" class="hidden items-center gap-2 bg-black/40 px-3 py-1 rounded-full border border-white/10">
                        <span class="text-lg">üí∞</span>
                        <span id="mini-balance-text" class="text-sm font-bold text-yellow-400">0</span>
                    </div>
                </div>
            </div>

            <div class="w-full mb-3">
                <div class="flex justify-between items-center mb-1">
                    <div class="flex items-center gap-2">
                        <span id="level-name" class="text-sm font-bold text-white">T·∫≠p s·ª±</span>
                        <span id="level-idx" class="text-[10px] text-gray-400">Lv 1/5</span>
                    </div>
                    <span id="level-progress-text" class="text-[10px] text-gray-400">0 / 500,000</span>
                </div>
                <div class="w-full h-3 bg-[#2d2d3e] rounded-full border border-[#3d3d52] overflow-hidden">
                    <div id="level-progress-bar" class="h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500 ease-out" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div id="tab-exchange" class="tab-content active px-4 pb-32 overflow-y-auto relative">
            <div class="flex w-full justify-between items-stretch mb-4 gap-2 z-20 relative">
                <div class="flex-1 bg-[#2d2d3e]/90 backdrop-blur p-2 rounded-xl border border-[#3d3d52] flex flex-col items-center justify-center">
                    <span class="text-[10px] text-gray-400 uppercase font-bold mb-1">Chuy·ªÉn ƒë·ªïi</span>
                    <div class="flex items-center gap-1.5">
                        <i data-lucide="plane" class="w-4 h-4 text-blue-400"></i>
                        <span id="tap-value" class="font-bold text-white text-sm">+1</span>
                    </div>
                </div>
                <div class="flex-1 bg-[#2d2d3e]/90 backdrop-blur p-2 rounded-xl border border-[#3d3d52] flex flex-col items-center justify-center">
                    <span class="text-[10px] text-gray-400 uppercase font-bold mb-1">ƒê·∫ßu t∆∞ ƒëang ch·∫°y</span>
                    <div class="flex items-center gap-2">
                        <i data-lucide="briefcase" class="w-4 h-4 text-green-400"></i>
                        <div class="flex flex-col items-start leading-none">
                            <span id="active-investments" class="font-bold text-white text-xs">0 g√≥i</span>
                            <span id="pending-return" class="text-[10px] text-green-400">+0</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex flex-col items-center mb-4 z-20 relative">
                <div class="flex items-center gap-3 transition-transform duration-300" id="balance-container">
                    <div class="w-10 h-10 rounded-full bg-yellow-500 flex items-center justify-center text-2xl shadow-lg border-2 border-yellow-300">üí∞</div>
                    <h1 id="balance-display" class="text-4xl font-black text-white tracking-wider drop-shadow-lg">0</h1>
                </div>
            </div>

            <div id="game-container" class="relative w-full aspect-[4/3] mx-auto rounded-2xl overflow-hidden shadow-2xl border-4 border-[#2d2d3e] mb-4 bg-gray-900 select-none cursor-pointer flex-shrink-0"></div>

            <div class="w-full max-w-[340px] mx-auto z-20 relative mt-auto">
                <div class="flex items-center justify-between mb-3 px-2">
                    <div class="flex items-center gap-2 bg-black/40 px-3 py-2 rounded-full border border-white/10 w-full relative">
                        <i data-lucide="zap" class="w-5 h-5 text-yellow-400 fill-current"></i>
                        <span class="font-bold text-sm flex-1"><span id="energy-display">1000</span> <span class="text-gray-400">/ <span id="max-energy-display">1000</span></span></span>
                        <button onclick="openModal('modal-boost')" class="flex items-center gap-1 px-3 py-1 rounded-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg border border-indigo-400 hover:scale-105 active:scale-95 transition-transform">
                            <i data-lucide="rocket" class="w-4 h-4"></i>
                            <span class="text-xs font-bold">N√¢ng C·∫•p</span>
                        </button>
                    </div>
                </div>
                <button id="main-action-btn" class="w-full py-4 rounded-2xl font-black text-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2 uppercase tracking-wide border-b-4 bg-gradient-to-b from-blue-500 to-blue-600 border-blue-800 text-white">
                    <i data-lucide="plane" class="w-6 h-6"></i>
                    <span class="btn-text">C·∫§T C√ÅNH</span>
                </button>
            </div>
        </div>

        <div id="tab-mine" class="tab-content px-4 pb-32 overflow-y-auto relative">
            <div class="bg-[#2d2d3e] rounded-2xl p-4 mb-6 border border-[#3d3d52] mt-4 shadow-lg">
                <div class="flex justify-between items-center mb-2">
                    <div class="text-gray-300 text-sm font-medium">Danh m·ª•c ƒë·∫ßu t∆∞</div>
                    <div class="bg-blue-900/50 px-2 py-1 rounded text-xs text-blue-300 font-bold border border-blue-800" id="mine-active-count">0 g√≥i</div>
                </div>
                <div class="flex items-end gap-2">
                    <div class="text-3xl font-black text-green-400 drop-shadow-md" id="mine-pending-return">+0</div>
                    <span class="text-xs text-gray-400 mb-1.5">üí∞ s·∫Øp nh·∫≠n v·ªÅ</span>
                </div>
            </div>
            <div id="investment-list" class="grid grid-cols-2 gap-3 pb-8"></div>
        </div>

        <div id="tab-quests" class="tab-content px-4 pb-32 overflow-y-auto relative">
            <div class="bg-[#2d2d3e] rounded-2xl p-6 mb-6 border border-[#3d3d52] text-center mt-4">
                <div class="w-16 h-16 bg-blue-900/50 rounded-full flex items-center justify-center mx-auto mb-3 border border-blue-700 shadow-[0_0_20px_rgba(37,99,235,0.3)]">
                    <i data-lucide="clipboard-list" class="w-8 h-8 text-blue-400"></i>
                </div>
                <h2 class="text-xl font-bold text-white">Nhi·ªám V·ª• Ki·∫øm Ti·ªÅn</h2>
            </div>
            <div class="mb-6">
                <h3 class="font-bold text-white flex items-center gap-2 mb-3 px-1"><i data-lucide="calendar" class="w-4 h-4 text-green-400"></i> ƒêi·ªÉm danh h√†ng ng√†y</h3>
                <div id="daily-checkin-list" class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide"></div>
            </div>
            <div class="space-y-3">
                <h3 class="font-bold text-white px-1 mb-2">Danh s√°ch nhi·ªám v·ª•</h3>
                <div id="tasks-list" class="space-y-3"></div>
            </div>
        </div>

        <div id="tab-friends" class="tab-content px-4 pb-32 overflow-y-auto relative">
            <div class="grid grid-cols-2 gap-3 mb-6 mt-4">
                <div class="bg-[#2d2d3e]/90 rounded-xl p-4 border border-[#3d3d52]">
                    <div class="text-xs text-gray-400 mb-1 flex items-center gap-1"><i data-lucide="users" class="w-4 h-4 text-blue-400"></i> L∆∞·ª£t m·ªùi</div>
                    <div id="invite-count" class="text-2xl font-black text-white">0</div>
                </div>
                <div class="bg-[#2d2d3e]/90 rounded-xl p-4 border border-[#3d3d52]">
                    <div class="text-xs text-gray-400 mb-1 flex items-center gap-1"><i data-lucide="wallet" class="w-4 h-4 text-green-400"></i> T·ªïng thu</div>
                    <div id="invite-earn" class="text-2xl font-black text-white">0</div>
                </div>
            </div>
            <div class="bg-[#2d2d3e]/90 rounded-2xl p-5 border border-[#3d3d52] mb-5 text-center">
                <div class="text-sm font-bold text-white mb-3">Qu√©t m√£ ƒë·ªÉ tham gia</div>
                <div class="bg-white p-3 rounded-xl inline-block"><img id="invite-qr" class="w-44 h-44" /></div>
            </div>
            <div class="bg-[#1c1c2e] rounded-xl p-3 border border-white/10 flex items-center gap-2 mb-4">
                <input id="invite-link" readonly class="flex-1 bg-transparent text-xs text-gray-300 outline-none" />
                <button onclick="copyInviteLink()" class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold active:scale-95 transition">COPY</button>
            </div>
            <div class="bg-[#2d2d3e]/80 rounded-xl p-4 border border-[#3d3d52] text-sm text-gray-300 space-y-2">
                <div class="flex gap-2"><span class="text-yellow-400">‚≠ê</span><span>G·ª≠i m√£ QR ho·∫∑c link gi·ªõi thi·ªáu cho b·∫°n b√®.</span></div>
                <div class="flex gap-2"><span class="text-yellow-400">‚≠ê</span><span>Nh·∫≠n <b class="text-yellow-400">10.000üíé</b> khi b·∫°n b√® t·∫°o t√†i kho·∫£n v√† bay chuy·∫øn bay ƒë·∫ßu ti√™n.</span></div>
                <div class="flex gap-2"><span class="text-yellow-400">‚≠ê</span><span>Kim c∆∞∆°ng c√≥ th·ªÉ d√πng ƒë·ªÉ n√¢ng c·∫•p ho·∫∑c ƒë·ªïi nƒÉng l∆∞·ª£ng.</span></div>
            </div>
        </div>

        <div id="tab-withdraw" class="tab-content px-4 pb-32 overflow-y-auto relative">
            <div class="bg-[#2d2d3e] rounded-2xl p-6 mb-6 border border-[#3d3d52] flex flex-col items-center mt-4">
                <div class="w-20 h-20 bg-purple-900/30 rounded-full flex items-center justify-center mb-4 border border-purple-500/50"><i data-lucide="wallet" class="w-10 h-10 text-purple-400"></i></div>
                <h2 class="text-xl font-bold text-white">R√∫t Ti·ªÅn V·ªÅ T√†i Kho·∫£n</h2>
                <div class="flex items-center gap-2 mt-2 bg-black/40 px-4 py-2 rounded-lg border border-white/5">
                    <span class="text-gray-400 text-xs">S·ªë d∆∞ kh·∫£ d·ª•ng:</span>
                    <span class="text-yellow-500 text-sm">üí∞</span>
                    <span class="font-bold text-white" id="withdraw-balance">0</span>
                </div>
            </div>
            <div class="bg-[#1c1c1e] rounded-2xl p-5 border border-white/10 mb-6">
                <div class="space-y-4">
                    <div class="relative">
                        <select id="bank-name" class="w-full bg-[#2c2c2e] text-white text-sm rounded-xl py-3 px-4 border border-white/5 focus:border-blue-500 outline-none appearance-none">
                            <option value="" disabled selected>Ch·ªçn ng√¢n h√†ng</option>
                            <option value="MB">MB Bank</option>
                            <option value="VCB">Vietcombank</option>
                            <option value="TCB">Techcombank</option>
                            <option value="ACB">ACB</option>
                            <option value="ICB">VietinBank</option>
                            <option value="BIDV">BIDV</option>
                            <option value="TPB">TPBank</option>
                            <option value="VPB">VPBank</option>
                        </select>
                        <div class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-gray-400"><i data-lucide="chevron-down" class="w-4 h-4"></i></div>
                    </div>
                    <input type="number" id="account-number" placeholder="S·ªë T√†i Kho·∫£n" class="w-full bg-[#2c2c2e] text-white text-sm rounded-xl py-3 px-4 border border-white/5 focus:border-blue-500 outline-none">
                    <input type="text" id="account-holder" placeholder="T√™n Ch·ªß T√†i Kho·∫£n" class="w-full bg-[#2c2c2e] text-white text-sm rounded-xl py-3 px-4 border border-white/5 focus:border-blue-500 outline-none uppercase">
                    <div>
                        <input type="number" id="withdraw-amount" placeholder="S·ªë Xu Mu·ªën R√∫t" class="w-full bg-[#2c2c2e] text-white text-sm rounded-xl py-3 px-4 border border-white/5 focus:border-blue-500 outline-none">
                        <div class="text-right mt-1 text-[10px] text-gray-500" id="withdraw-rate">Quy ƒë·ªïi: 0 VNƒê</div>
                    </div>
                    <button id="withdraw-btn" onclick="submitWithdraw(this)" class="w-full py-3 bg-gradient-to-r from-purple-600 to-blue-600 rounded-xl font-bold text-white shadow-lg active:scale-95 transition-transform mt-2">G·ª≠i Y√™u C·∫ßu</button>
                </div>
            </div>
            <div class="mb-4">
                <h3 class="font-bold text-white flex items-center gap-2 mb-3 px-1"><i data-lucide="history" class="w-4 h-4 text-gray-400"></i> L·ªãch s·ª≠ r√∫t ti·ªÅn</h3>
                <div id="withdraw-history" class="space-y-2"></div>
            </div>
        </div>

        <div class="absolute bottom-4 left-1/2 -translate-x-1/2 w-[95%] max-w-md bg-[#1a1a24]/95 backdrop-blur-xl rounded-2xl border border-white/10 p-2 grid grid-cols-5 gap-1 z-50 shadow-2xl">
            <button onclick="switchTab('exchange')" class="nav-btn active rounded-lg py-2 flex flex-col items-center justify-center gap-1" id="nav-exchange"><i data-lucide="plane" class="w-5 h-5"></i><span class="text-[9px]">Bay</span></button>
            <button onclick="switchTab('mine')" class="nav-btn rounded-lg py-2 flex flex-col items-center justify-center gap-1" id="nav-mine"><i data-lucide="pickaxe" class="w-5 h-5"></i><span class="text-[9px]">ƒê·∫ßu t∆∞</span></button>
            <button onclick="switchTab('quests')" class="nav-btn rounded-lg py-2 flex flex-col items-center justify-center gap-1" id="nav-quests"><i data-lucide="clipboard-list" class="w-5 h-5"></i><span class="text-[9px]">Nhi·ªám v·ª•</span></button>
            <button onclick="switchTab('friends')" class="nav-btn rounded-lg py-2 flex flex-col items-center justify-center gap-1" id="nav-friends"><i data-lucide="users" class="w-5 h-5"></i><span class="text-[9px]">ƒê·ªôi bay</span></button>
            <button onclick="switchTab('withdraw')" class="nav-btn rounded-lg py-2 flex flex-col items-center justify-center gap-1" id="nav-withdraw"><i data-lucide="wallet" class="w-5 h-5"></i><span class="text-[9px]">R√∫t ti·ªÅn</span></button>
        </div>
    </div>

    <div id="modal-boost" class="modal-overlay" onclick="closeModal('modal-boost')">
        <div class="w-full max-w-sm bg-[#1c1c1e] rounded-2xl p-5 border border-white/10 animate-zoom-in relative mx-4" onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-gray-400" onclick="closeModal('modal-boost')"><i data-lucide="x" class="w-6 h-6"></i></button>
            <div class="text-center mb-6">
                <h2 class="text-xl font-bold text-yellow-400 flex items-center justify-center gap-2"><i data-lucide="rocket" class="w-6 h-6"></i> N√¢ng C·∫•p</h2>
                <p class="text-gray-400 text-xs mt-1">C·∫£i ti·∫øn k·ªπ thu·∫≠t ƒë·ªÉ bay xa h∆°n</p>
            </div>
            <div class="space-y-4" id="boost-list"></div>
        </div>
    </div>

    <div id="modal-task" class="modal-overlay" onclick="closeModal('modal-task')">
        <div class="w-full max-w-sm bg-[#1c1c1e] rounded-2xl p-6 border border-white/10 animate-zoom-in relative mx-4" onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-gray-400" onclick="closeModal('modal-task')"><i data-lucide="x" class="w-6 h-6"></i></button>
            <div class="flex flex-col items-center text-center mb-6 pt-2">
                <div class="w-20 h-20 bg-[#2c2c2e] rounded-2xl flex items-center justify-center mb-4 text-4xl shadow-lg border border-white/5" id="task-icon">üì∫</div>
                <h2 class="text-xl font-bold text-white mb-2" id="task-name">T√™n nhi·ªám v·ª•</h2>
                <div class="flex items-center gap-1 bg-blue-900/30 px-3 py-1 rounded-full border border-blue-700/50">
                    <span class="text-xl font-black text-blue-400" id="task-reward">+0</span>
                    <span class="text-lg">üíé</span>
                </div>
            </div>
            <button onclick="doTaskAction()" class="w-full py-3 mb-3 bg-blue-600 hover:bg-blue-500 rounded-xl text-white font-bold flex items-center justify-center gap-2 active:scale-95 transition-all" id="task-btn-action">Tham gia ngay <i data-lucide="chevron-right" class="w-4 h-4"></i></button>
            <button onclick="checkTaskAction()" class="w-full py-3 bg-green-600 hover:bg-green-500 rounded-xl text-white font-bold flex items-center justify-center gap-2 active:scale-95 transition-all" id="task-btn-check">Ki·ªÉm tra</button>
        </div>
    </div>

    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="app.js"></script>
    <script>
        // JS t·∫°o hi·ªáu ·ª©ng Loading gi·∫£ l·∫≠p
        window.addEventListener('load', () => {
            const bar = document.getElementById('loading-progress');
            const text = document.getElementById('loading-text');
            
            // Gi·∫£ l·∫≠p ti·∫øn tr√¨nh (n·∫øu app.js ch∆∞a k·ªãp load)
            let w = 0;
            const intv = setInterval(() => {
                if(w < 90) { // Ch·∫°y ƒë·∫øn 90% r·ªìi ƒë·ª£i
                    w += Math.random() * 5;
                    if(w > 90) w = 90;
                    bar.style.width = w + '%';
                    
                    if(w < 30) text.innerText = 'ƒêang kh·ªüi ƒë·ªông ƒë·ªông c∆°...';
                    else if(w < 60) text.innerText = 'ƒêang k·∫øt n·ªëi v·ªá tinh...';
                    else text.innerText = 'ƒêang t·∫£i d·ªØ li·ªáu...';
                }
            }, 100);

            // Khi App.js load xong (n√≥ s·∫Ω g·ªçi h√†m ·∫©n loading), interval n√†y s·∫Ω b·ªã clear
            window.stopLoadingSim = () => clearInterval(intv);
        });
    </script>
</body>
</html>
